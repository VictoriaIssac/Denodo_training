CREATE OR REPLACE VIEW sales FOLDER = '/examples/optimizer examles/caching + mpp' AS SELECT ss_sold_date_sk, ss_sold_time_sk, ss_item_sk, ss_customer_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_quantity, ss_wholesale_cost, ss_list_price, ss_sales_price, ss_ext_discount_amt, ss_ext_sales_price, ss_ext_wholesale_cost, ss_ext_list_price, ss_ext_tax, ss_coupon_amt, ss_net_paid, ss_net_paid_inc_tax, ss_net_profit FROM (SELECT * FROM impala_store_sales UNION SELECT ss_item_sk, ss_ext_sales_price, ss_ext_tax, ss_net_paid_inc_tax, ss_cdemo_sk, ss_store_sk, ss_promo_sk, ss_customer_sk, ss_coupon_amt, ss_net_profit, ss_quantity, ss_ticket_number, ss_ext_discount_amt, ss_addr_sk, ss_sold_time_sk, ss_sales_price, ss_list_price, ss_net_paid, ss_hdemo_sk, ss_ext_wholesale_cost, ss_wholesale_cost, ss_sold_date_sk, ss_ext_list_price FROM oracle_store_sales);

ALTER VIEW sales
 LAYOUT (impala_store_sales = [40, 50, 200, 225], oracle_store_sales = [388, 43, 200, 225]);

