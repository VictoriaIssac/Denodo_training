CREATE OR REPLACE VIEW current_sales FOLDER = '/examples/optimizer examles/partitioning by date' AS SELECT oracle_store_sales.ss_sold_date_sk AS ss_sold_date_sk, oracle_store_sales.ss_sold_time_sk AS ss_sold_time_sk, oracle_store_sales.ss_item_sk AS ss_item_sk, oracle_store_sales.ss_customer_sk AS ss_customer_sk, oracle_store_sales.ss_cdemo_sk AS ss_cdemo_sk, oracle_store_sales.ss_hdemo_sk AS ss_hdemo_sk, oracle_store_sales.ss_addr_sk AS ss_addr_sk, oracle_store_sales.ss_store_sk AS ss_store_sk, oracle_store_sales.ss_promo_sk AS ss_promo_sk, oracle_store_sales.ss_ticket_number AS ss_ticket_number, oracle_store_sales.ss_quantity AS ss_quantity, oracle_store_sales.ss_wholesale_cost AS ss_wholesale_cost, oracle_store_sales.ss_list_price AS ss_list_price, oracle_store_sales.ss_sales_price AS ss_sales_price, oracle_store_sales.ss_ext_discount_amt AS ss_ext_discount_amt, oracle_store_sales.ss_ext_sales_price AS ss_ext_sales_price, oracle_store_sales.ss_ext_wholesale_cost AS ss_ext_wholesale_cost, oracle_store_sales.ss_ext_list_price AS ss_ext_list_price, oracle_store_sales.ss_ext_tax AS ss_ext_tax, oracle_store_sales.ss_coupon_amt AS ss_coupon_amt, oracle_store_sales.ss_net_paid AS ss_net_paid, oracle_store_sales.ss_net_paid_inc_tax AS ss_net_paid_inc_tax, oracle_store_sales.ss_net_profit AS ss_net_profit, oracle_date_dim.d_date AS d_date FROM oracle_store_sales AS oracle_store_sales INNER JOIN oracle_date_dim AS oracle_date_dim ON oracle_store_sales.ss_sold_date_sk = oracle_date_dim.d_date_sk  WHERE oracle_date_dim.d_date >= DATE '2017-01-01';

ALTER VIEW current_sales
 LAYOUT (oracle_store_sales = [20, 20, 200, 225], oracle_date_dim = [370, 20, 200, 225]);

