CREATE OR REPLACE VIEW historical_sales FOLDER = '/examples/optimizer examles/partitioning by date' AS SELECT impala_store_sales.ss_sold_date_sk AS ss_sold_date_sk, impala_store_sales.ss_sold_time_sk AS ss_sold_time_sk, impala_store_sales.ss_item_sk AS ss_item_sk, impala_store_sales.ss_customer_sk AS ss_customer_sk, impala_store_sales.ss_cdemo_sk AS ss_cdemo_sk, impala_store_sales.ss_hdemo_sk AS ss_hdemo_sk, impala_store_sales.ss_addr_sk AS ss_addr_sk, impala_store_sales.ss_store_sk AS ss_store_sk, impala_store_sales.ss_promo_sk AS ss_promo_sk, impala_store_sales.ss_ticket_number AS ss_ticket_number, impala_store_sales.ss_quantity AS ss_quantity, impala_store_sales.ss_wholesale_cost AS ss_wholesale_cost, impala_store_sales.ss_list_price AS ss_list_price, impala_store_sales.ss_sales_price AS ss_sales_price, impala_store_sales.ss_ext_discount_amt AS ss_ext_discount_amt, impala_store_sales.ss_ext_sales_price AS ss_ext_sales_price, impala_store_sales.ss_ext_wholesale_cost AS ss_ext_wholesale_cost, impala_store_sales.ss_ext_list_price AS ss_ext_list_price, impala_store_sales.ss_ext_tax AS ss_ext_tax, impala_store_sales.ss_coupon_amt AS ss_coupon_amt, impala_store_sales.ss_net_paid AS ss_net_paid, impala_store_sales.ss_net_paid_inc_tax AS ss_net_paid_inc_tax, impala_store_sales.ss_net_profit AS ss_net_profit, impala_date_dim.d_date AS d_date FROM impala_store_sales AS impala_store_sales INNER JOIN impala_date_dim AS impala_date_dim ON impala_store_sales.ss_sold_date_sk = impala_date_dim.d_date_sk  WHERE impala_date_dim.d_date < DATE '2017-01-01';

ALTER VIEW historical_sales
 LAYOUT (impala_store_sales = [20, 20, 200, 225], impala_date_dim = [310, 20, 200, 225]);

